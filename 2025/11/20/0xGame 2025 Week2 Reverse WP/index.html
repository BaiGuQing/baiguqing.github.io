<!DOCTYPE html>
<html lang="zh-cn">
  <head prefix="og: https://ogp.me/ns#">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="light dark">
  
  <title>0xGame 2025 Week2 Reverse WP - GuQing&#39;s Blog</title>
  
    <link rel="shortcut icon" href="/favicon.jpg">
  
  
  <link rel='manifest' href='/manifest.json'>
  

  <meta name="description" content="引言 我是一名CTF萌新啊，做这么详细的WP，也是希望能够帮助像我一样的新手，如果大佬发现WP有问题可以评论，我会改进！  16 bit 这个官方文档写的比较详细，那我就仔细的讲一下过程 运行这个exe会发现运行不了，据官方WP所说，这个是16位的应⽤程序，是由汇编语⾔直接编写再编译的，现代操作系统⼀般都无法直接运行，但它还是⼆进制⽂件，ida可以分析，不过F5⼀键出伪代码就没法⽤了  方法1：观">
<meta property="og:type" content="article">
<meta property="og:title" content="0xGame 2025 Week2 Reverse WP">
<meta property="og:url" content="http://example.com/2025/11/20/0xGame%202025%20Week2%20Reverse%20WP/index.html">
<meta property="og:site_name" content="GuQing&#39;s Blog">
<meta property="og:description" content="引言 我是一名CTF萌新啊，做这么详细的WP，也是希望能够帮助像我一样的新手，如果大佬发现WP有问题可以评论，我会改进！  16 bit 这个官方文档写的比较详细，那我就仔细的讲一下过程 运行这个exe会发现运行不了，据官方WP所说，这个是16位的应⽤程序，是由汇编语⾔直接编写再编译的，现代操作系统⼀般都无法直接运行，但它还是⼆进制⽂件，ida可以分析，不过F5⼀键出伪代码就没法⽤了  方法1：观">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/Images/20251119232320.png">
<meta property="og:image" content="http://example.com/Images/20251119232721.png">
<meta property="og:image" content="http://example.com/Images/20251119234654.png">
<meta property="og:image" content="http://example.com/Images/20251119234736.png">
<meta property="og:image" content="http://example.com/Images/20251119235037.png">
<meta property="og:image" content="http://example.com/Images/20251119235101.png">
<meta property="og:image" content="http://example.com/Images/20251119235117.png">
<meta property="og:image" content="http://example.com/Images/20251119235159.png">
<meta property="og:image" content="http://example.com/Images/20251120001054.png">
<meta property="og:image" content="http://example.com/Images/20251120001153.png">
<meta property="og:image" content="http://example.com/Images/20251120001258.png">
<meta property="og:image" content="http://example.com/Images/20251120001339.png">
<meta property="og:image" content="http://example.com/Images/20251120001414.png">
<meta property="og:image" content="http://example.com/Images/20251120134453.png">
<meta property="og:image" content="http://example.com/Images/20251120134831.png">
<meta property="og:image" content="http://example.com/Images/20251120135340.png">
<meta property="og:image" content="http://example.com/Images/20251120135354.png">
<meta property="og:image" content="http://example.com/Images/20251120135657.png">
<meta property="og:image" content="http://example.com/Images/20251120135739.png">
<meta property="og:image" content="http://example.com/Images/20251120140702.png">
<meta property="article:published_time" content="2025-11-19T16:00:00.000Z">
<meta property="article:modified_time" content="2025-12-18T08:09:20.649Z">
<meta property="article:author" content="GuQing">
<meta property="article:tag" content="Reverse_Writeup">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/Images/20251119232320.png">

  <link rel="preconnect" href="https://rsms.me/">
  <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
  
  
<link rel="stylesheet" href="https://unpkg.com/simple-icons-font@15/font/simple-icons.min.css">

  
  
  
<link rel="stylesheet" href="https://unpkg.com/bootstrap-icons@1/font/bootstrap-icons.min.css">

  

  
<link rel="stylesheet" href="/css/var.css">

  
<link rel="stylesheet" href="/css/main.css">

  
<link rel="stylesheet" href="/css/typography.css">

  
<link rel="stylesheet" href="/css/code-highlighting.css">

  
  
  
<link rel="stylesheet" href="/css/components/card.css">

  
  
  
  
<link rel="stylesheet" href="/css/components/button.css">

  
  
  
  
<link rel="stylesheet" href="/css/components/badge.css">

  
  
  
  
<link rel="stylesheet" href="/css/components/utilities.css">

  
  
  
  
<link rel="stylesheet" href="/css/components/carousel.css">

  
  
  
<link rel="stylesheet" href="/css/nav.css">

  
<link rel="stylesheet" href="/css/paginator.css">

  
<link rel="stylesheet" href="/css/footer.css">

  
<link rel="stylesheet" href="/css/post-list.css">

  
  
  
<link rel="stylesheet" href="/css/toc.css">

  
  
  
  
  
<link rel="stylesheet" href="/css/post.css">

  
  
  
  
  
  
  
<link rel="stylesheet" href="/css/scroll-reveal.css">

  
  
  
<link rel="stylesheet" href="/css/view-transition.css">

  
  

  

  
<script src="/js/head.js"></script>

  
<meta name="generator" content="Hexo 8.1.1"></head>

  <body
    data-color-scheme="auto"
    data-uppercase-categories="true"
    
    data-config-root="/"
    
    data-toc="true"
    data-toc-max-depth="2"
    
    
    
    data-scroll-reveal-disappear="false"
    data-scroll-reveal-query=".scroll-reveal, .post-list-item, .card, .content p img, .content .block-large img"
    
    data-nav-blur-gradient="false"
    data-corner-squircle="true"
  >
    
<script src="/js/body-top.js"></script>

    <a href="#main-content" id="skip-to-content">跳至主要内容</a>
    

<nav id="theme-nav">
  <div class="inner">
    <a class="title" href="/">GuQing&#39;s Blog</a>
    <div class="nav-arrow"></div>
    <div class="nav-items">
      <a class="nav-item nav-item-home" href="/" style="--index: 0">主页</a>

      
      <a class="nav-item" href="/About-Me" style="--index: 1">关于</a>
      
      <a class="nav-item" href="/archives" style="--index: 2">归档</a>
      
      <a class="nav-item" href="/tags" style="--index: 3">标签</a>
      
      <a class="nav-item" href="/categories" style="--index: 4">分类</a>
      
      <a class="nav-item is-icon" href="/search" style="--index: 5"><i class="bi bi-search"></i></a>
      
    </div>
  </div>
</nav>

    <main id="main-content" data-pagefind-body>
      
<article class="post">
  
  <div class="meta">
    
    <div class="categories text-uppercase">
    
      <a href="/categories/CTF-WP/">CTF_WP</a>
    
    </div>
    

    
    <time class="date" datetime="2025-11-20T00:00:00+08:00">
      2025-11-20
    </time>
    

    <h1 class="title" data-pagefind-meta="title">0xGame 2025 Week2 Reverse WP</h1>
  </div>

  <div class="content">
    <h1 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h1><ul>
<li>我是一名CTF萌新啊，做这么详细的WP，也是希望能够帮助像我一样的新手，如果大佬发现WP有问题可以评论，我会改进！</li>
</ul>
<h1 id="16-bit"><a href="#16-bit" class="headerlink" title="16 bit"></a>16 bit</h1><ul>
<li>这个官方文档写的比较详细，那我就仔细的讲一下过程</li>
<li>运行这个exe会发现运行不了，据官方WP所说，这个是16位的应⽤程序，是由汇编语⾔直接编写再编译的，现代操作系统⼀般都无法直接运行，但它还是⼆进制⽂件，ida可以分析，不过F5⼀键出伪代码就没法⽤了</li>
</ul>
<h2 id="方法1：观看反汇编"><a href="#方法1：观看反汇编" class="headerlink" title="方法1：观看反汇编"></a>方法1：观看反汇编</h2><ul>
<li><p>可以把汇编代码复制给ai，然后问一下它这段代码写的啥，这里就结合ai进行解释了</p>
</li>
<li><p>IDA不会用的可以看我的Week1</p>
</li>
<li><p><img src="/Images/20251119232320.png"></p>
</li>
<li><p>第1行：<code>mov ax, seg dseg</code></p>
<ul>
<li><strong><code>seg dseg</code></strong>：<ul>
<li><code>dseg</code> 是程序中定义的一个<strong>数据段</strong>的名称。</li>
<li><code>seg</code> 是一个<strong>操作符</strong>，它获取 <code>dseg</code> 这个段的<strong>段地址</strong>（段基址）。</li>
<li>在实模式下，内存地址由 <code>段地址:偏移地址</code> 组成。</li>
</ul>
</li>
<li><strong><code>mov ax, seg dseg</code></strong>：<ul>
<li>将数据段 <code>dseg</code> 的段地址加载到 <strong>AX 寄存器</strong>中。</li>
<li>AX 在这里作为临时中转寄存器。</li>
</ul>
</li>
</ul>
</li>
<li><p>第2行：<code>mov ds, ax</code></p>
<ul>
<li><strong><code>mov ds, ax</code></strong>：<ul>
<li>将 AX 寄存器中的值（即 <code>dseg</code> 的段地址）移动到 <strong>DS 寄存器</strong>。</li>
<li><strong>DS</strong> 是<strong>数据段寄存器</strong>，它定义了程序中数据访问的默认段。</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>为什么不能直接 <code>mov ds, seg dseg</code>？</strong></p>
<ul>
<li>在 x86 架构中，大多数指令不允许将立即数直接移动到段寄存器。</li>
<li>必须通过通用寄存器（如 AX）进行中转。</li>
</ul>
</li>
<li><p>第3行：<code>assume ds:dseg</code></p>
<ul>
<li><strong><code>assume</code></strong>：<ul>
<li>这是一个<strong>汇编器伪指令</strong>，不是 CPU 指令。</li>
<li>它<strong>不生成任何机器代码</strong>，只是给汇编器提供信息。</li>
</ul>
</li>
</ul>
</li>
<li><p><img src="/Images/20251119232721.png"></p>
</li>
<li><p>其实这一段不用看，因为下面又给覆盖了 :(</p>
</li>
<li><p>只是把sub和xor的位置颠倒了，所以这段和后面那段就一块讲了</p>
</li>
<li><p>sub是减法，xor是异或</p>
</li>
<li><p>cx是循环计数器，mov是赋值语法，0x17 &#x3D; 23，也就是循环23次</p>
</li>
<li><p>loc_1000E:后面就是循环结构</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">loc_1000E:</span><br><span class="line">mov     al, [si+0Ah]   ; 从 [SI+0x0A] 加载一个字节到 AL</span><br><span class="line">sub     al, 9          ; AL = AL - 9</span><br><span class="line">xor     al, 0Eh        ; AL = AL XOR 0x0E</span><br><span class="line">mov     [di+38h], al   ; 将结果存储到 [DI+0x38]</span><br><span class="line">inc     si             ; SI++</span><br><span class="line">inc     di             ; DI++</span><br><span class="line">loop    loc_1000E      ; CX--, 如果CX≠0则继续循环</span><br></pre></td></tr></table></figure>
<ul>
<li>再往下看</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mov     byte_100A6, 24h ; &#x27;$&#x27;  ; 在地址 66h 写入 &#x27;$&#x27; 终止符</span><br><span class="line">mov     dx, 67h         ; 设置字符串起始地址为 67h</span><br><span class="line">mov     ah, 9           ; 设置功能号：输出字符串</span><br><span class="line">int     21h             ; 调用 DOS 输出</span><br></pre></td></tr></table></figure>
<ul>
<li>下面那段也类似就不解释了，什么，你问我这个地址在哪看？把鼠标滚轮往下滚，你会得知答案</li>
<li>然后你已经看懂了汇编，就可以试着写一写python脚本来推算出flag，我不是很会，就用ai生成脚本了</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># decode_flag.py</span></span><br><span class="line"><span class="comment"># 从汇编逻辑还原 flag</span></span><br><span class="line"></span><br><span class="line">data = [</span><br><span class="line"><span class="number">0x47</span>,<span class="number">0x7F</span>,<span class="number">0x52</span>,<span class="number">0x78</span>,<span class="number">0x6C</span>,<span class="number">0x74</span>,<span class="number">0x7E</span>,<span class="number">0x72</span>,<span class="number">0x47</span>,<span class="number">0x47</span>,<span class="number">0x73</span>,<span class="number">0x5A</span>,<span class="number">0x84</span>,<span class="number">0x5A</span>,<span class="number">0x43</span>,<span class="number">0x85</span>,<span class="number">0x46</span>,<span class="number">0x5A</span>,<span class="number">0x83</span>,<span class="number">0x6F</span>,<span class="number">0x46</span>,<span class="number">0x5A</span>,<span class="number">0x6C</span>,</span><br><span class="line"><span class="number">0x33</span>,<span class="number">0x30</span>,<span class="number">0x73</span>,<span class="number">0x32</span>,<span class="number">0x75</span>,<span class="number">0x66</span>,<span class="number">0x37</span>,<span class="number">0x61</span>,<span class="number">0x66</span>,<span class="number">0x33</span>,<span class="number">0x30</span>,<span class="number">0x78</span>,<span class="number">0x66</span>,<span class="number">0x40</span>,<span class="number">0x35</span>,<span class="number">0x61</span>,<span class="number">0x4E</span>,<span class="number">0x64</span>,<span class="number">0x34</span>,<span class="number">0x65</span>,<span class="number">0x32</span>,<span class="number">0x33</span>,<span class="number">0x88</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">out = []</span><br><span class="line"><span class="comment"># 第一个循环（前 23 字节）：先 sub 9，再 xor 0x0E</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">23</span>):</span><br><span class="line">    al = data[i]</span><br><span class="line">    al = (al - <span class="number">9</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    al = al ^ <span class="number">0x0E</span></span><br><span class="line">    out.append(al)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 第二个循环（后 23 字节）：先 xor 0x0E，再 sub 9</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">23</span>, <span class="number">46</span>):</span><br><span class="line">    al = data[i]</span><br><span class="line">    al = al ^ <span class="number">0x0E</span></span><br><span class="line">    al = (al - <span class="number">9</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    out.append(al)</span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">bytes</span>(out).decode(<span class="string">&#x27;latin1&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<ul>
<li>另外提一嘴，国内的ai真的不太好用，写脚本都是错的:p</li>
</ul>
<h2 id="方法2：配置Dosbox运行"><a href="#方法2：配置Dosbox运行" class="headerlink" title="方法2：配置Dosbox运行"></a>方法2：配置Dosbox运行</h2><ul>
<li>不用看其他人配置Dosbox了，太麻烦，看我的精简版</li>
<li>从<a target="_blank" rel="noopener" href="https://www.dosbox.com/">DOSBox, an x86 emulator with DOS</a>下载</li>
<li><img src="/Images/20251119234654.png"></li>
<li>进去之后啥也不用点，等几秒就行，别点那老鼻子广告都是假的下载按钮</li>
<li><img src="/Images/20251119234736.png"></li>
<li>下载好之后，就随便安装个地方，我就安装在z盘了</li>
<li>然后打开Dosbox，你会发现不管你安装在哪个磁盘，默认进去就是z:&#x2F;，没有关系，那只是他内部的磁盘罢了，利用mount c 你放exe文件夹的路径，来挂起这个文件夹当做内部磁盘c盘，如果你嫌麻烦，可以点击这个</li>
<li><img src="/Images/20251119235037.png"></li>
<li>在最下面填上</li>
<li><img src="/Images/20251119235101.png"></li>
<li><img src="/Images/20251119235117.png"></li>
<li>然后进入Dosbox，输入16bit.exe就行了</li>
<li><img src="/Images/20251119235159.png"></li>
</ul>
<h1 id="BabyJar"><a href="#BabyJar" class="headerlink" title="BabyJar"></a>BabyJar</h1><ul>
<li>这个很简单，直接拖到jadx，查看反的java代码，看不懂喂给ai让它写脚本</li>
<li>jadx下载<a target="_blank" rel="noopener" href="https://github.com/skylot/jadx/releases">Releases · skylot&#x2F;jadx (github.com)</a></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64  </span><br><span class="line">  </span><br><span class="line">key = <span class="number">0x14</span>  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">base64_text: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:  </span><br><span class="line">    decoded_bytes = base64.b64decode(base64_text)  </span><br><span class="line">    decrypted = <span class="built_in">bytearray</span>()  </span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> decoded_bytes:  </span><br><span class="line">        temp = ((c &amp; <span class="number">0xF0</span>) &gt;&gt; <span class="number">4</span>) | ((c &amp; <span class="number">0x0F</span>) &lt;&lt; <span class="number">4</span>)  </span><br><span class="line">        decrypted.append(temp ^ key)  </span><br><span class="line">    <span class="keyword">return</span> decrypted.decode(<span class="string">&quot;latin1&quot;</span>)  </span><br><span class="line">  </span><br><span class="line">ciphertext = <span class="string">&quot;QsY1V5cX9jJyF2JSAgdikwfCEneTAgICUpNnd1Iyk8IXUkJ3QhcyZ8J3YpY=&quot;</span>  </span><br><span class="line"><span class="built_in">print</span>(decrypt(ciphertext))</span><br></pre></td></tr></table></figure>
<h1 id="TELF"><a href="#TELF" class="headerlink" title="TELF"></a>TELF</h1><ul>
<li>依旧查壳，可以看Week1，由于大部分说过，所以省略些部分</li>
<li><img src="/Images/20251120001054.png"></li>
<li>可以看到有个UPX壳，我们去脱，发现脱不了壳</li>
<li><img src="/Images/20251120001153.png"></li>
<li>官方WP写的很清楚啊，我们去下个Winhex，吾爱破解就有，自行下载</li>
<li>upx执行脱壳逻辑的时候，会先识别⼀下⽂件内部的upx标识，也就是”upx”这个字符串，upx只有识别到了它才能认识这个upx程序，从而执行脱壳。</li>
<li>反之，如果⼈为地修改这个upx标识，让upx⽆法识别出来，那么脱壳就会失败，这道题就是这样。只要把被修改的字符串改回去就⾏了</li>
<li><img src="/Images/20251120001258.png"></li>
<li>改一下</li>
<li><img src="/Images/20251120001339.png"></li>
<li>就成功了</li>
<li><img src="/Images/20251120001414.png"></li>
<li>丢到IDA，查看c语言伪代码</li>
<li>可以注意到，密钥是动态生成的，若需要得到密钥则需要动态调试，但本题是elf文件，动态调试需要远程挂linux（具体操作可以自行搜索学习）</li>
<li>有的师傅可能做过相关题⽬，觉得动态调试有点麻烦，因此直接在本地windows的编译器⾥⾯设置相同的种⼦，然后模拟出随机数列得到密钥，最后发现密钥不对</li>
<li>这是因为windows和linux两个系统对于随机数的⽣成逻辑不太⼀样，这个程序是在linux中运⾏的，所以在windows系统⽆法模拟出来正确的密钥顺序，必须要在linux中运⾏才可以得到正确的密钥</li>
<li>上面是我引用的官方的WP，很高深，学习到了:&gt;</li>
<li>这里引用官方WP所给的脚本以及源代码</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span>  </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span>  </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span>  </span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DELTA 0x9e3779b9  </span></span><br><span class="line">  </span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt</span><span class="params">(<span class="type">uint32_t</span> *v, <span class="type">uint32_t</span> *k)</span> &#123;  </span><br><span class="line">    <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>];  </span><br><span class="line">  </span><br><span class="line">    <span class="type">uint32_t</span> sum = DELTA * <span class="number">32</span>;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;  </span><br><span class="line">        v1 -= ((v0 &lt;&lt; <span class="number">4</span>) + k[<span class="number">2</span>]) ^ (v0 + sum) ^ ((v0 &gt;&gt; <span class="number">5</span>) + k[<span class="number">3</span>]);  </span><br><span class="line">  </span><br><span class="line">        v0 -= ((v1 &lt;&lt; <span class="number">4</span>) + k[<span class="number">0</span>]) ^ (v1 + sum) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k[<span class="number">1</span>]);  </span><br><span class="line">  </span><br><span class="line">        sum -= DELTA;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    v[<span class="number">0</span>] = v0;  </span><br><span class="line">  </span><br><span class="line">    v[<span class="number">1</span>] = v1;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;  </span><br><span class="line">    <span class="type">uint32_t</span> key[<span class="number">4</span>] = &#123;<span class="number">0x7E4D087B</span>, <span class="number">0x7A4DB733</span>, <span class="number">0x70FE9DF0</span>, <span class="number">0x595607F7</span>&#125;;  </span><br><span class="line">  </span><br><span class="line">    <span class="type">uint8_t</span> enc[<span class="number">56</span>] = &#123;  </span><br><span class="line">  </span><br><span class="line">        <span class="number">0xAD</span>, <span class="number">0xDA</span>, <span class="number">0x01</span>, <span class="number">0xDC</span>, <span class="number">0xAE</span>, <span class="number">0x5B</span>, <span class="number">0x8A</span>, <span class="number">0x08</span>,  </span><br><span class="line">  </span><br><span class="line">        <span class="number">0x4E</span>, <span class="number">0xF5</span>, <span class="number">0x4F</span>, <span class="number">0x8F</span>, <span class="number">0x6E</span>, <span class="number">0x5F</span>, <span class="number">0x9D</span>, <span class="number">0x9E</span>,  </span><br><span class="line">  </span><br><span class="line">        <span class="number">0x0A</span>, <span class="number">0x4E</span>, <span class="number">0xA9</span>, <span class="number">0x08</span>, <span class="number">0x25</span>, <span class="number">0xAB</span>, <span class="number">0x45</span>, <span class="number">0xC2</span>,  </span><br><span class="line">  </span><br><span class="line">        <span class="number">0x4B</span>, <span class="number">0xC9</span>, <span class="number">0x8F</span>, <span class="number">0x43</span>, <span class="number">0x3D</span>, <span class="number">0x51</span>, <span class="number">0xD6</span>, <span class="number">0x28</span>,  </span><br><span class="line">  </span><br><span class="line">        <span class="number">0xF6</span>, <span class="number">0x72</span>, <span class="number">0xCD</span>, <span class="number">0xF4</span>, <span class="number">0x2B</span>, <span class="number">0xB4</span>, <span class="number">0x4A</span>, <span class="number">0x3B</span>,  </span><br><span class="line">  </span><br><span class="line">        <span class="number">0xFB</span>, <span class="number">0x36</span>, <span class="number">0x66</span>, <span class="number">0xEF</span>, <span class="number">0xD6</span>, <span class="number">0x8A</span>, <span class="number">0x8C</span>, <span class="number">0xB2</span>,  </span><br><span class="line">  </span><br><span class="line">        <span class="number">0xEB</span>, <span class="number">0x1A</span>, <span class="number">0x9C</span>, <span class="number">0x1B</span>, <span class="number">0x0A</span>, <span class="number">0x9C</span>, <span class="number">0x1F</span>, <span class="number">0x53</span>  </span><br><span class="line">  </span><br><span class="line">    &#125;;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">56</span>; i += <span class="number">8</span>) &#123;  </span><br><span class="line">        <span class="type">uint32_t</span> v[<span class="number">2</span>];  </span><br><span class="line">  </span><br><span class="line">        <span class="built_in">memcpy</span>(&amp;v, enc + i, <span class="number">8</span>);  </span><br><span class="line">  </span><br><span class="line">        decrypt(v, key);  </span><br><span class="line">  </span><br><span class="line">        <span class="built_in">memcpy</span>(enc + i, &amp;v, <span class="number">8</span>);  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">56</span>; i++) &#123;  </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, enc[i]);  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>源代码</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span>  </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span>  </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span>  </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span>  </span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DELTA 0x9e3779b9  </span></span><br><span class="line"><span class="type">void</span> <span class="title function_">encrypt</span><span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> &#123;  </span><br><span class="line">    <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>];  </span><br><span class="line">    <span class="type">uint32_t</span> sum = <span class="number">0</span>;  </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;  </span><br><span class="line">        sum += DELTA;  </span><br><span class="line">        v0 += ((v1 &lt;&lt; <span class="number">4</span>) + k[<span class="number">0</span>]) ^ (v1 + sum) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k[<span class="number">1</span>]);  </span><br><span class="line">        v1 += ((v0 &lt;&lt; <span class="number">4</span>) + k[<span class="number">2</span>]) ^ (v0 + sum) ^ ((v0 &gt;&gt; <span class="number">5</span>) + k[<span class="number">3</span>]);  </span><br><span class="line">    &#125;  </span><br><span class="line">    v[<span class="number">0</span>] = v0;  </span><br><span class="line">    v[<span class="number">1</span>] = v1;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="type">uint8_t</span> enc[<span class="number">56</span>] = &#123;  </span><br><span class="line">    <span class="number">0xAD</span>, <span class="number">0xDA</span>, <span class="number">0x01</span>, <span class="number">0xDC</span>, <span class="number">0xAE</span>, <span class="number">0x5B</span>, <span class="number">0x8A</span>, <span class="number">0x08</span>,  </span><br><span class="line">    <span class="number">0x4E</span>, <span class="number">0xF5</span>, <span class="number">0x4F</span>, <span class="number">0x8F</span>, <span class="number">0x6E</span>, <span class="number">0x5F</span>, <span class="number">0x9D</span>, <span class="number">0x9E</span>,  </span><br><span class="line">    <span class="number">0x0A</span>, <span class="number">0x4E</span>, <span class="number">0xA9</span>, <span class="number">0x08</span>, <span class="number">0x25</span>, <span class="number">0xAB</span>, <span class="number">0x45</span>, <span class="number">0xC2</span>,  </span><br><span class="line">    <span class="number">0x4B</span>, <span class="number">0xC9</span>, <span class="number">0x8F</span>, <span class="number">0x43</span>, <span class="number">0x3D</span>, <span class="number">0x51</span>, <span class="number">0xD6</span>, <span class="number">0x28</span>,  </span><br><span class="line">    <span class="number">0xF6</span>, <span class="number">0x72</span>, <span class="number">0xCD</span>, <span class="number">0xF4</span>, <span class="number">0x2B</span>, <span class="number">0xB4</span>, <span class="number">0x4A</span>, <span class="number">0x3B</span>,  </span><br><span class="line">    <span class="number">0xFB</span>, <span class="number">0x36</span>, <span class="number">0x66</span>, <span class="number">0xEF</span>, <span class="number">0xD6</span>, <span class="number">0x8A</span>, <span class="number">0x8C</span>, <span class="number">0xB2</span>,  </span><br><span class="line">    <span class="number">0xEB</span>, <span class="number">0x1A</span>, <span class="number">0x9C</span>, <span class="number">0x1B</span>, <span class="number">0x0A</span>, <span class="number">0x9C</span>, <span class="number">0x1F</span>, <span class="number">0x53</span>  </span><br><span class="line">    &#125;;  </span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;  </span><br><span class="line">    srand(<span class="number">1010000</span>);  </span><br><span class="line">    <span class="type">uint32_t</span> key[<span class="number">4</span>];  </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;  </span><br><span class="line">        key[i] = (<span class="type">uint32_t</span>)rand();  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="type">char</span> input[<span class="number">57</span>];  </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Please input your flag: &quot;</span>);  </span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%56s&quot;</span>, input) != <span class="number">1</span>) &#123;  </span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;Input error or EOF\n&quot;</span>);  </span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strlen</span>(input) != <span class="number">56</span>) &#123;  </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Length Error!\n&quot;</span>);  </span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="type">uint8_t</span> input_buf[<span class="number">56</span>] = &#123;<span class="number">0</span>&#125;;  </span><br><span class="line">    <span class="built_in">memcpy</span>(input_buf, input, <span class="number">56</span>);  </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">56</span>; i += <span class="number">8</span>) &#123;  </span><br><span class="line">        <span class="type">uint32_t</span> v[<span class="number">2</span>];  </span><br><span class="line">        <span class="built_in">memcpy</span>(&amp;v, input_buf + i, <span class="number">8</span>);  </span><br><span class="line">        encrypt(v, key);  </span><br><span class="line">        <span class="built_in">memcpy</span>(input_buf + i, &amp;v, <span class="number">8</span>);  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">56</span>; i++)  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">if</span> (enc[i]!=input_buf[i])  </span><br><span class="line">        &#123;  </span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Try Again!&quot;</span>);  </span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Congratulation!\n&quot;</span>);  </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>最后结果为</li>
<li><img src="/Images/20251120134453.png"></li>
</ul>
<h1 id="算术高手"><a href="#算术高手" class="headerlink" title="算术高手"></a>算术高手</h1><ul>
<li>把它丢进DIE中，可以看到它是pyinstaller打包的exe</li>
<li><img src="/Images/20251120134831.png"></li>
<li>PyInstaller 是⼀个把 Python 脚本及其依赖打包成独立可执行文件（如 .exe），方便分发和运行的工具</li>
<li>也就是说这个exe文件里是一堆python代码和依赖文件，不是传统的二进制文件，所以说ida无法分析这个exe文件</li>
<li><a target="_blank" rel="noopener" href="https://github.com/extremecoders-re/pyinstxtractor">https://github.com/extremecoders-re/pyinstxtractor</a></li>
<li>下载这个工具，分离那些文件</li>
<li><img src="/Images/20251120135340.png"></li>
<li><img src="/Images/20251120135354.png"></li>
<li>下载<code>uncompyle6</code></li>
<li><code>pip install uncompyle6</code></li>
<li><code>uncompyle6 -o . yourfile.pyc</code></li>
<li>这个<code>.</code>是生成文件在根目录</li>
<li>在生成的文件夹下打开cmd</li>
<li><img src="/Images/20251120135657.png"></li>
<li>然后就能找到.py</li>
<li><img src="/Images/20251120135739.png"></li>
<li>看到flag，并且这道题认真计算做的话也是得不到flag的，可以看看源代码</li>
</ul>
<h1 id="Shuffle！Shuffle！"><a href="#Shuffle！Shuffle！" class="headerlink" title="Shuffle！Shuffle！"></a>Shuffle！Shuffle！</h1><ul>
<li>直接丢进IDA，看下c语言伪代码</li>
<li><img src="/Images/20251120140702.png"></li>
<li>这两个地方可以双击点开，esc返回，看下函数</li>
<li>当你把那些信息喂给ai，它给你的脚本是几乎得不到答案的</li>
<li>看看这个官方WP的脚本吧</li>
<li>⽤了随机数打乱，随机种⼦固定，所以可以写代码模拟乱序的序列，然后恢复字符串的正确顺序，但实际上更推荐另⼀种方法：动态调试⼀个固定长度字符全不同的字符串，得到其加密结果，就能还原任意密文。</li>
<li>简单来说，就是我们可以先随便输入⼀个没有重复字符且长度和flag相等的字符串，得到它的乱序结果，然后和被乱序的flag进行对比，就能得到正确的flag</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">enc=<span class="string">&#x27;23-64bed6&#125;-xm5300-&#123;faGa34-0e04c2e7c2a78f39a4&#x27;</span> <span class="comment"># 待恢复的密⽂字符串</span></span><br><span class="line"></span><br><span class="line">test=<span class="string">&#x27;kL9f2hEwR0xB8YpQvNjOtCz1Dg5sV3UaH4MbrX7iAqS+&#x27;</span> <span class="comment"># 明⽂字符串</span></span><br><span class="line"></span><br><span class="line">test2=<span class="string">&#x27;Nbgz45vH3+UL2wMj8tE0x97DCQphksVAa1XqfiSRYBrO&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 被乱序的明⽂字符串，将明⽂字符串输⼊程序运⾏后的结果，可以动态调试抓取</span></span><br><span class="line"></span><br><span class="line">swap=[[<span class="number">0</span>]*<span class="number">44</span>,</span><br><span class="line"></span><br><span class="line">[<span class="number">0</span>]*<span class="number">44</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(test)):</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(test2)):</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> test[i]==test2[j]:</span><br><span class="line"></span><br><span class="line">swap[<span class="number">0</span>][i]=i</span><br><span class="line"></span><br><span class="line">swap[<span class="number">1</span>][i]=j</span><br><span class="line"></span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(swap)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line"></span><br><span class="line">flag+=enc[swap[<span class="number">1</span>][i]]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><ul>
<li>这Reverse的题，我如果不看WP可能也只会做出来BabyJar那道题，有些东西确实是看不懂，只能慢慢学了，很多思路和脚本也不是很理解</li>
<li>本WP是基于官方WP更为详细的版本，只是我复现的过程，希望能帮助到你</li>
<li>题目需要到<a target="_blank" rel="noopener" href="https://www.ctfplus.cn/%E8%87%AA%E5%8F%96">https://www.ctfplus.cn/自取</a></li>
</ul>

  </div>

  
  <div class="about" data-pagefind-ignore>
    <h2>关于本文</h2>
    <div class="details">
      <p>由 GuQing 撰写，采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc/4.0">CC BY-NC 4.0</a> 许可协议。</p>
    </div>
    
    <p class="tags">
      <i class="bi bi-tags icon"></i>
      
      <a href="/tags/Reverse-Writeup/" class="tag">#Reverse_Writeup</a>
      
    </p>
    
    
  </div>
  

  <div class="container post-prev-next" data-pagefind-ignore>
    
    <a href="/2025/12/16/0xGame%202025%20Week3%20Reverse%20WP/" class="next">
      <div class="text">
        <p class="label">下一篇</p>
        <h3 class="title">0xGame 2025 Week3 Reverse WP</h3>
      </div>
    </a>
    
    
    <a href="/2025/11/19/0xGame%202025%20Week1%20Reverse%20WP/" class="prev">
      <div class="text">
        <p class="label">上一篇</p>
        <h3 class="title">0xGame 2025 Week1 Reverse WP</h3>
      </div>
    </a>
    
  </div>

  
    
    
  
</article>


    </main>
    <footer>
  <div class="inner">
    <div class="links">
      
      <div class="group">
        <h2 class="title">Blog</h2>
        
        <a href="/" class="item">主业</a>
        
        <a href="/About-Me" class="item">关于</a>
        
        <a href="/archives" class="item">归档</a>
        
        <a href="/tags" class="item">标签</a>
        
        <a href="/categories" class="item">分类</a>
        
        <a href="/search" class="item">搜索</a>
        
      </div>
      
      <div class="group">
        <h2 class="title">Related</h2>
        
        <a target="_blank" rel="noopener" href="https://hexo.io/" class="item">Hexo</a>
        
      </div>
      
    </div>
    <span>&copy; 2025 GuQing<br>由 <a href="http://hexo.io/" target="_blank">Hexo</a> 驱动</span>
    
    
      <br>
      <div class="color-scheme-toggle" role="radiogroup" id="theme-color-scheme-toggle">
        <label>
          <input type="radio" value="light">
          <span>浅色</span>
        </label>
        <label>
          <input type="radio" value="dark">
          <span>深色</span>
        </label>
        <label>
          <input type="radio" value="auto">
          <span>自动</span>
        </label>
      </div>
    
  </div>
</footer>


    
<script src="/js/main.js"></script>


    

    
    
<script src="/js/scroll-reveal.js"></script>

    

    

    

    
  </body>
</html>
